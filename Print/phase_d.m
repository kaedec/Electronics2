%--------------------------------------------------------------------
function [theta] = phase_d(Z)
%--------------------------------------------------------------------

X = real(Z);

Y = imag(Z);

%--------------------------------------------------------------------

theta = atand(Y ./ X);

%--------------------------------------------------------------------

for ii = 1:length(Z)
    
    if X(ii) == 0
        
        theta(ii) = 90 * sign(Y(ii));
    end
    
    if Y(ii) == 0 & X(ii) < 0
        
        theta(ii) = 180;
    end
    
    if X(ii) < 0 & Y(ii) < 0
        
        theta(ii) = theta(ii) - 180;
        
    end
    
    if X(ii) < 0 & Y(ii) > 0
        
        theta(ii) = theta(ii) + 180;
        
    end
   
end

%--------------------------------------------------------------------
